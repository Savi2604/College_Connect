<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Leave Status</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f7f7; padding: 20px; }
        .header { display: flex; align-items: center; gap: 15px; margin-bottom: 25px; color: #008080; }
        .status-card { 
            background: white; padding: 20px; border-radius: 15px; margin-bottom: 15px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); border-left: 8px solid #f39c12; 
        }
        .info b { display: block; font-size: 18px; color: #333; }
        .status-badge { 
            background: #fff4e5; color: #f39c12; padding: 8px 15px; 
            border-radius: 20px; font-weight: bold; font-size: 14px;
            text-transform: uppercase;
        }
        /* Approved/Rejected styles */
        .approved-card { border-left-color: #27ae60 !important; }
        .approved-badge { background: #eafaf1 !important; color: #27ae60 !important; }
        .rejected-card { border-left-color: #e74c3c !important; }
        .rejected-badge { background: #fdedec !important; color: #e74c3c !important; }
    </style>
</head>
<body>

    <div class="header">
        <a href="index.html" style="color: #008080;"><i class="fas fa-arrow-left fa-lg"></i></a>
        <h2>My Leave Status</h2>
    </div>

    <div id="status-container">
        <p style="text-align:center;">Loading requests...</p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAZOJh_a5oDaKluV3IU6Ly2o7PlTlSEbhQ",
            authDomain: "college-connect-2cd42.firebaseapp.com",
            databaseURL: "https://college-connect-2cd42-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "college-connect-2cd42",
            storageBucket: "college-connect-2cd42.firebasestorage.app",
            messagingSenderId: "16394931571",
            appId: "1:16394931571:web:38b8abc12ec26d7dc50906"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const container = document.getElementById('status-container');

        // Path: leaverequests (as per your screenshot)
        onValue(ref(db, 'leaverequests'), (snapshot) => {
            console.log("Data received:", snapshot.val()); // Browser console-la check panna
            container.innerHTML = "";

            if (snapshot.exists()) {
                snapshot.forEach(child => {
                    const req = child.val();
                    
                    // Matching "STU001" exactly
                    if(req.studentID === "STU001") {
                        let cardClass = "";
                        let badgeClass = "";

                        if(req.status === "Approved") {
                            cardClass = "approved-card";
                            badgeClass = "approved-badge";
                        } else if(req.status === "Rejected") {
                            cardClass = "rejected-card";
                            badgeClass = "rejected-badge";
                        }

                        container.innerHTML += `
                            <div class="status-card ${cardClass}">
                                <div class="info">
                                    <b>${req.type}</b>
                                    <span style="color:#666; font-size:14px;">Date: ${req.date}</span>
                                    <p style="margin:5px 0; font-size:13px; font-style:italic;">Reason: ${req.reason}</p>
                                </div>
                                <div class="status-badge ${badgeClass}">${req.status}</div>
                            </div>`;
                    }
                });
            } else {
                container.innerHTML = "<p style='text-align:center;'>No requests found in Database.</p>";
            }
        });
    </script>
</body>
</html>